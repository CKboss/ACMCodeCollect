# Sdoi 2016

BZOJ 4513 ~ 4518

#### BZOJ 4513: [Sdoi2016]储能表

找规律,对于每一个2^N的数,和一个2^N以内的数异或会产生0~2^N个不同的数,然后递归就可以了.

#### BZOJ 4514: [Sdoi2016]数字配对

费用流问题,建图比较巧妙.
把所有数字按照质因子的个数的奇偶分到两边,然后建图跑最小费用最大流.
这里的费用流求的是在费用>=0之前的最大的流量,所以应该在每次增广路之后进行判断,当费用开始小于0的时候,就可以停止增广了.


#### BZOJ 4517: [Sdoi2016]排列计数
 
错排数和组合数取模

#### BZOJ 4518: [Sdoi2016]征途
化简:
$m^2* \frac{1}{m}\sum_{i=1}^m(x_i-\overline{x})$
$m*\sum_{i=1}^{m}(x_i^2+2x_i\frac{L}{m}+\frac{L^2}{m})$
$\sum_{i=1}^{m}(m*x_i^2-2x_iL+\frac{L^2}{m})$
$m*\sum_{i=1}^{m}x_i^2-L^2$ 


 即要求每段的平方和最小: $dp[o][i] = dp[o-1][j] + len(j->i)^2$ 这个可以用斜率优化dp优化.


#### BZOJ 4516: [Sdoi2016]生成魔咒

后缀数组,先将原串翻转.所求即为后缀中不同的子串的数目.
每插入一个后缀,会和已经插入的后缀产生一些重复的子串.对于所插入的后缀r,它的左边一个后缀为L,它的右边一个后缀为R
则新增加的重复的子串有 Lcp(r,L)+Lcp(r,R)-Lcp(R,L)